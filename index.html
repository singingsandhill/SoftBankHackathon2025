<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deploy Â· GitHub Actions (Normal Case)</title>
    <style>
      :root{
        --bg:#0b1220;--fg:#e5e7eb;--muted:#9ca3af;--accent:#7c3aed;--ok:#10b981;--err:#ef4444
      }
      *{box-sizing:border-box}
      html,body{height:100%}
      body{margin:0;display:grid;place-items:center;background:radial-gradient(800px 500px at 10% 0%, #121a2f, #0b1220);color:var(--fg);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif}
      .card{width:min(520px,92vw);background:rgba(255,255,255,.04);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.08);border-radius:18px;box-shadow:0 12px 30px rgba(0,0,0,.35);padding:22px}
      h1{margin:0 0 8px;font-size:18px}
      p{margin:0 0 12px;color:var(--muted);font-size:14px}
      .btn{appearance:none;border:0;border-radius:14px;padding:14px 18px;font-weight:800;letter-spacing:.2px;cursor:pointer;background:linear-gradient(180deg,var(--accent),#6d28d9);color:white;box-shadow:0 10px 20px rgba(124,58,237,.35);width:100%}
      .btn[disabled]{opacity:.6;cursor:not-allowed}
      .status{margin-top:14px;padding:10px 12px;border-radius:12px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);font-family:ui-monospace,Menlo,Consolas,monospace;font-size:12px}
      .ok{color:var(--ok)}
      .err{color:var(--err)}
      .hint{margin-top:10px;font-size:12px;color:var(--muted)}
      .kbd{font-family:ui-monospace,Menlo,monospace;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-bottom-width:2px;padding:1px 6px;border-radius:6px}
      .small{font-size:12px}
      .iframe-container{margin-top:20px}
      .iframe-container h3{margin:0 0 10px;font-size:16px;color:var(--fg)}
      .iframe-container iframe{width:100%;height:400px;border:1px solid rgba(255,255,255,.08);border-radius:12px;background:rgba(255,255,255,.02)}
    </style>
  </head>
  <body>
    <div class="card">
      <h1>GitHub Actions ë°°í¬ íŠ¸ë¦¬ê±°</h1>
      <p class="small">ë²„íŠ¼ í•˜ë‚˜ë¡œ <span class="kbd">workflow_dispatch</span> ì´ë²¤íŠ¸ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. (Normal case)</p>

      <button id="deployBtn" class="btn" type="button">ğŸš€ ë°°í¬ ì‹¤í–‰</button>
      <div id="status" class="status" role="status" aria-live="polite">ëŒ€ê¸° ì¤‘â€¦</div>
      <div class="hint">â€» ë¸Œë¼ìš°ì €ì—ì„œ ì§ì ‘ GitHub APIë¥¼ í˜¸ì¶œí•˜ë¯€ë¡œ, í…ŒìŠ¤íŠ¸ ìš©ë„ë¡œë§Œ ì‚¬ìš©í•˜ì„¸ìš”. í† í°ì€ <strong>ì ˆëŒ€</strong> ì €ì¥/ì»¤ë°‹í•˜ì§€ ë§ˆì„¸ìš”.</div>
      
      <div class="iframe-container">
        <h3>ğŸŒ Eureka Service Registry</h3>
        <iframe src="http://3.34.94.55:8761/" title="Eureka Server Dashboard" frameborder="0"></iframe>
      </div>
    </div>

    <script>
      // ====== ìµœì†Œ ì„¤ì • (í•„ìˆ˜ ê°’ ì±„ì›Œì£¼ì„¸ìš”) ======
      const CONFIG = {
        owner: 'singingsandhill',             // ê¹ƒí—ˆë¸Œ ì‚¬ìš©ì/ì¡°ì§ëª…
        repo: 'SoftBankHackathon2025',        // ë ˆí¬ì§€í† ë¦¬ëª…
        workflow_id: 'deploy.yml',            // .github/workflows/<íŒŒì¼ëª…> ë˜ëŠ” ì›Œí¬í”Œë¡œìš° ID
        ref: 'main',                          // ì‹¤í–‰í•  ë¸Œëœì¹˜/íƒœê·¸
        inputs: {                             // ì›Œí¬í”Œë¡œìš° inputs (ì„ íƒ)
          environment: 'stg'
        },
        token: 'YOUR_GITHUB_TOKEN'            // GitHub Fine-grained ë˜ëŠ” classic PAT (repo ê¶Œí•œ)
      };
      // ==========================================

      const $ = (s) => document.querySelector(s);
      const statusEl = $('#status');
      const btn = $('#deployBtn');

      function setStatus(text, cls){
        statusEl.className = 'status' + (cls ? ' ' + cls : '');
        statusEl.textContent = text;
      }

      // async function triggerDispatch(){
      //   const {owner, repo, workflow_id, ref, inputs, token} = CONFIG;
      //   if(!token || token === 'YOUR_GITHUB_TOKEN'){
      //     setStatus('í† í°ì„ ì„¤ì •í•˜ì„¸ìš”. (CONFIG.token)', 'err');
      //     return;
      //   }
      //   btn.disabled = true;
      //   setStatus('ìš”ì²­ ì „ì†¡ ì¤‘â€¦');

      //   const url = `https://api.github.com/repos/${owner}/${repo}/actions/workflows/${workflow_id}/dispatches`;
      //   try {
      //     const res = await fetch(url, {
      //       method: 'POST',
      //       headers: {
      //         'Accept': 'application/vnd.github+json',
      //         'Authorization': `Bearer ${token}`,
      //         'X-GitHub-Api-Version': '2022-11-28',
      //         'Content-Type': 'application/json'
      //       },
      //       body: JSON.stringify({ ref, inputs })
      //     });

      //     if(res.status === 204){
      //       setStatus('âœ… íŠ¸ë¦¬ê±° ì„±ê³µ â€” ì›Œí¬í”Œë¡œìš°ê°€ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤. (Actions íƒ­ì—ì„œ í™•ì¸)', 'ok');
      //     } else {
      //       const text = await res.text();
      //       setStatus(`âŒ ì‹¤íŒ¨ (HTTP ${res.status}) â€” ${text || 'ì‘ë‹µ ë³¸ë¬¸ ì—†ìŒ'}`, 'err');
      //     }
      //   } catch (e){
      //     setStatus('âŒ ë„¤íŠ¸ì›Œí¬/ë¸Œë¼ìš°ì € ì˜¤ë¥˜: ' + (e?.message || e), 'err');
      //   } finally {
      //     btn.disabled = false;
      //   }
      // }

      // btn.addEventListener('click', triggerDispatch);
      
      // ê¸°ëŠ¥ ë¹„í™œì„±í™” - UIë§Œ í‘œì‹œ
      btn.addEventListener('click', function() {
        setStatus('ğŸ”§ ë°°í¬ ê¸°ëŠ¥ì´ ì¼ì‹œì ìœ¼ë¡œ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'err');
      });
    </script>
  </body>
</html>
